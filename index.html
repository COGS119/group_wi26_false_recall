<!DOCTYPE html>
<html>

<head>
  <title>My experiment</title>
  <script src="https://unpkg.com/jspsych@8.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-survey-text@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-survey-likert@2.0.0"></script>
  <!-- load in the recall lists-->
  <script src="https://unpkg.com/@jspsych/plugin-preload@2.0.0"></script> 
  <script src="stimuli/roediger_mcdermott_1995_appendix_word_list.js"></script>
  <link href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
</head>

<body></body>
<script>

  /* initialize jsPsych */
  var jsPsych = initJsPsych({
    on_finish: function () {
      jsPsych.data.displayData();
    }
  });

  

  //Hi

  /* create timeline */
  var timeline = [];

  //preloading audio here
var preload = {
  type: jsPsychPreload,
  audio: []
};
timeline.push(preload);

  //Welcome message
  var welcome = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: "Welcome to the False Recall experiment. <p>Press any key to begin.</p>"
  };

  timeline.push(welcome)

  //get one of the lists
  var current_list = memory_lists[0];
  console.log(current_list);

  //add general instructions
  var instructions = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: 
     `<p>Listen to the following words. Do your best to memorize as many words as accurately as possible.<p>
      <p>The first trial will begin after this screen<p>
        <p> Press any key to continue<p> 
   `
     };

  //push recall instructions
  timeline.push(instructions)

  //for loop code was giving some errors, commented out for now but will work on fixing soon
     //for loop for trials
     //contains list stimulus, free recall, and gap 
    //  for (i = 1; i <= number_of_lists; i++) {
    //   var trial = {
    //     type: jsPsychHtmlKeyboardResponse,
    //     choices: [],
    //     stimulus: current_list,
    //     trial_duration: 22500,
    //     post_trial_gap: 1000
    //   }

    //   var free_recall = {
    //     type: jsPsychSurveyText,
    //     preamble:"Please write down every word you remeber being in the list given. Only write the word if you are fairly confident it was present",
    //     questions: [
    //       { 
    //       name:"word"
    //     },{
    //       name:"word"

    //     }
    //   ]

    //   }
    //  }

  // //present each element in the list during the memory phase
  // var number_words_in_list = 15;
  // for (i = 1; i <= number_words_in_list; i++) {
  //   //present the current word in the list
  //   var trial = {
  //     type: jsPsychHtmlKeyboardResponse,
  //     choices: [],
  //     stimulus: current_list["word_" + i],
  //     trial_duration: 1500,
  //     post_trial_gap: 5000
  //   }
  //   timeline.push(trial);
  // }


  //2.5 min gap for recall
//   var recall_countdown = {
//   type: jsPsychHtmlKeyboardResponse,
//   choices: "NO_KEYS",
//   trial_duration: 150000, // 2 min 30 sec in ms
//   stimulus: function () {
//     var remaining = jsPsych.getCurrentTrial().trial_duration -
//                     jsPsych.getTotalTime();

//     var totalSeconds = Math.ceil(remaining / 1000);
//     var minutes = Math.floor(totalSeconds / 60);
//     var seconds = totalSeconds % 60;

//     return `
//       <p> Now take a moment to remember the list you just heard</p>
//       <p>Time remaining: <strong>${minutes}:${seconds.toString().padStart(2, '0')}</strong></p>
//     `;
//   }
// };

// timeline.push(recall_countdown);

  //instructuons for recognition
 var recognition_intro = {
  type: jsPsychHtmlKeyboardResponse,
    stimulus: 
     `<p>You will now receive another test.<p> 
      <p>Here you will be shown a series of words that you may have seen previously. Your task is to rate your confidence of seeing these words on a 4 point scale<p>
      <p>1: Definitely new<p> 
      <p>2: Maybe new<p>
      <p>3: Maybe seen before<p>
      <p>4: Definitely seen before<p>
      <p>Press any key to continue<p> 
   ` };

//push recognition test intructions
timeline.push(recognition_intro);

 //Test Blocks for each list
var recgonition_blocks = [
  ["Table", "Floor", "Ball", "Shoe", "Couch", "Relax", "Chair"],
  ["Peak", "Hike", "Draw", "Hill", "Car", "Snow", "Mountain"],
  ["Thread","Splinter","Pin","Stitch","Stop","Fast","Needle"],
  ["Tough","Chalk","Key","Smooth","Spike","Project","Rough"],
  ["Bed","Calm","Chess","Fish","Tired","Coma","Sleep"],
  ["Sugar","Cherry","Door","Salty","Ghost","Sour","Sweet"]
];

var recognition_trial = {
  type: jsPsychSurveyLikert,
  questions: [
    {
      prompt: function () {
        return "<h2>" +
          jsPsych.timelineVariable("word") +
          "</h2>";
      },
      label: [
        "1: Definitely New",
        "2: Maybe New",
        "3: Maybe Seen Before",
        "4: Definitely Seen Before"
      ],
      required: true
    }
  ],
  };  data: {
    word: jsPsych.timelineVariable("word")
  },
  post_trial_gap: 2000

var recognition_critical_lures = {
  type: jsPsychSurveyLikert,
  questions: [ 
    { 
      prompt: "Was 'chair' in the list you heard?",
      labels: ["yes", "no"] 
      required: true 
    }, 
    { 
      prompt: "Was 'mountain' in the list you heard?",
      labels: ["yes", "no"] 
      required: true 
    }, 
    { 
      prompt: "Was 'needle' in the list you heard?",
      labels: ["yes", "no"] 
      required: true 
    }, 
    { 
      prompt: "Was 'rough' in the list you heard?",
      labels: ["yes", "no"] 
      required: true 
    }, 
    { 
      prompt: "Was 'sleep' in the list you heard?",
      labels: ["yes", "no"] 
      required: true 
    }, 
    { 
      prompt: "Was 'sweet' in the list you heard?",
      labels: ["yes", "no"] 
      required: true
    }
  ]

};

//recognition code was giving some errors, commented out for now but will work on fixing soon
// recognition_blocks.forEach(function(block){
//   var trials = block.map(function(word){
//     return { word: word };
//   });
//   timeline.push({
//     timeline: [recognition_trial],
//     timeline_variables: trials
//   });
// });





  /* start the experiment */
  jsPsych.run(timeline);

</script>

</html>
